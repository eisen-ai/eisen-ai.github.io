


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>eisen.transforms.imaging &mdash; Eisen Documentation</title>
  

  
  
  
  
    <link rel="canonical" href="http://docs.eisen.ai/_modules/eisen/transforms/imaging.html"/>
  

  

  
  
    

  

  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" /> -->
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="../../../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../../../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="http://docs.eisen.ai/" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://eisen-ai.github.io/docs/index.html">Home</a>
          </li>

          <li>
            <a href="https://eisen-ai.github.io/docs/eisen/getstarted.html">Get Started</a>
          </li>

          <li>
            <a href="https://eisen-ai.github.io/docs/eisen/tutorials.html">Tutorials</a>
          </li>

          <li>
            <a href="https://eisen-ai.github.io/docs/eisen/features.html">Features</a>
          </li>

          <li>
            <a href="https://github.com/eisen-ai">GitHub</a>
          </li>

          <li>
            <a href="http://builder.eisen.ai">Builder</a>
          </li>

          <li>
            <a href="http://eisen.ai">Website</a>
          </li>

        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
                <div class="version">
                  latest
                </div>
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Home</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Eisen Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html#links">Links</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html#indices-and-tables">Indices and tables</a></li>
</ul>
<p class="caption"><span class="caption-text">Eisen-Core API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../eisen/api.html">Eisen</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../eisen/api.html#eisen-datasets">Eisen.datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../eisen/api.html#eisen-io">Eisen.io</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../eisen/api.html#module-eisen.transforms">Eisen.transforms</a></li>
</ul>
<p class="caption"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../eisen/getstarted.html">Get Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../eisen/getstarted.html#obtain-eisen-using-pypi">Obtain Eisen using PyPi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../eisen/getstarted.html#obtain-eisen-using-dockerhub">Obtain Eisen using DockerHub</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../eisen/tutorials.html">Tutorials</a></li>
</ul>
<p class="caption"><span class="caption-text">Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../eisen/features.html">Features</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="../../../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
          <li><a href="../../index.html">Module code</a> &gt;</li>
        
      <li>eisen.transforms.imaging</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <h1>Source code for eisen.transforms.imaging</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">eisen</span> <span class="kn">import</span> <span class="n">EPS</span>
<span class="kn">from</span> <span class="nn">nilearn.image</span> <span class="kn">import</span> <span class="n">resample_img</span>


<span class="k">def</span> <span class="nf">pad_to_minimal_size</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">pad_mode</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">):</span>
    <span class="n">pad</span> <span class="o">=</span> <span class="n">size</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:])</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">pad</span><span class="p">[</span><span class="n">pad</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">pad_before</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">pad</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">pad_after</span> <span class="o">=</span> <span class="p">(</span><span class="n">pad</span> <span class="o">-</span> <span class="n">pad_before</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="n">pad_vector</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">ndim</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">ndim</span> <span class="o">-</span> <span class="mi">3</span><span class="p">):</span>
            <span class="n">pad_vector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pad_vector</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pad_before</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">pad_after</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">array</span><span class="o">=</span><span class="n">image</span><span class="p">,</span> <span class="n">pad_width</span><span class="o">=</span><span class="n">pad_vector</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">pad_mode</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">image</span><span class="p">,</span> <span class="n">pad_before</span><span class="p">,</span> <span class="n">pad_after</span>


<div class="viewcode-block" id="CreateConstantFlags"><a class="viewcode-back" href="../../../eisen/api.html#eisen.transforms.imaging.CreateConstantFlags">[docs]</a><span class="k">class</span> <span class="nc">CreateConstantFlags</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transform allowing to create new fields in the data dictionary containing constants of any type</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        from eisen.transforms import CreateConstantFlags</span>
<span class="sd">        tform = CreateConstantFlags([&#39;my_field&#39;, &#39;my_text&#39;], [42.0, &#39;hello&#39;])</span>
<span class="sd">        tform = tform(data)</span>

<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="CreateConstantFlags.__init__"><a class="viewcode-back" href="../../../eisen/api.html#eisen.transforms.imaging.CreateConstantFlags.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param fields: names of the fields of data dictionary to work on</span>
<span class="sd">        :type fields: list of str</span>
<span class="sd">        :param values: list of float value to add to data</span>
<span class="sd">        :type values: list of float</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            from eisen.transforms import CreateConstantFlags</span>

<span class="sd">            tform = CreateConstantFlags(</span>
<span class="sd">                fields=[&#39;my_field&#39;, &#39;my_text&#39;],</span>
<span class="sd">                values=[42.0, &#39;hello&#39;]</span>
<span class="sd">            )</span>

<span class="sd">        &lt;json&gt;</span>
<span class="sd">        [</span>
<span class="sd">            {&quot;name&quot;: &quot;fields&quot;, &quot;type&quot;: &quot;list:string&quot;, &quot;value&quot;: &quot;&quot;},</span>
<span class="sd">            {&quot;name&quot;: &quot;values&quot;, &quot;type&quot;: &quot;list:float&quot;, &quot;value&quot;: &quot;&quot;}</span>
<span class="sd">        ]</span>
<span class="sd">        &lt;/json&gt;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">fields</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">values</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param data: Data dictionary to be processed by this transform</span>
<span class="sd">        :type data: dict</span>
<span class="sd">        :return: Updated data dictionary</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">field</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
            <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="RenameFields"><a class="viewcode-back" href="../../../eisen/api.html#eisen.transforms.imaging.RenameFields">[docs]</a><span class="k">class</span> <span class="nc">RenameFields</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transform allowing to rename fields in the data dictionary</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        from eisen.transforms import RenameFields</span>
<span class="sd">        tform = RenameFields([&#39;old_name1&#39;, &#39;old_name2&#39;], [&#39;new_name1&#39;, &#39;new_name2&#39;])</span>
<span class="sd">        tform = tform(data)</span>

<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="RenameFields.__init__"><a class="viewcode-back" href="../../../eisen/api.html#eisen.transforms.imaging.RenameFields.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">new_fields</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param fields: list of names of the fields of data dictionary to rename</span>
<span class="sd">        :type fields: list of str</span>
<span class="sd">        :param new_fields: new field names for the data dictionary</span>
<span class="sd">        :type new_fields: list of str</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            from eisen.transforms import RenameFields</span>

<span class="sd">            tform = RenameFields(</span>
<span class="sd">                fields=[&#39;old_name1&#39;, &#39;old_name2&#39;],</span>
<span class="sd">                new_fields=[&#39;new_name1&#39;, &#39;new_name2&#39;]</span>
<span class="sd">            )</span>

<span class="sd">        &lt;json&gt;</span>
<span class="sd">        [</span>
<span class="sd">            {&quot;name&quot;: &quot;fields&quot;, &quot;type&quot;: &quot;list:string&quot;, &quot;value&quot;: &quot;&quot;},</span>
<span class="sd">            {&quot;name&quot;: &quot;new_fields&quot;, &quot;type&quot;: &quot;list:string&quot;, &quot;value&quot;: &quot;&quot;}</span>
<span class="sd">        ]</span>
<span class="sd">        &lt;/json&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">fields</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_fields</span> <span class="o">=</span> <span class="n">new_fields</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">new_fields</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">field</span><span class="p">,</span> <span class="n">new_field</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_fields</span><span class="p">):</span>
            <span class="n">data</span><span class="p">[</span><span class="n">new_field</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="FilterFields"><a class="viewcode-back" href="../../../eisen/api.html#eisen.transforms.imaging.FilterFields">[docs]</a><span class="k">class</span> <span class="nc">FilterFields</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transform allowing to retain in the data dictionary only a list of fields specified as init argument</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        from eisen.transforms import FilterFields</span>
<span class="sd">        tform = FilterFields([&#39;field1&#39;, &#39;field2&#39;])</span>
<span class="sd">        tform = tform(data)</span>

<span class="sd">    The resulting data dictionary will only have &#39;field1&#39; and &#39;field2&#39; as keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="FilterFields.__init__"><a class="viewcode-back" href="../../../eisen/api.html#eisen.transforms.imaging.FilterFields.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fields</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param fields: list of fields to KEEP after the transform</span>
<span class="sd">        :type fields: list of str</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            from eisen.transforms import FilterFields</span>
<span class="sd">            tform = FilterFields(fields=[&#39;field1&#39;, &#39;field2&#39;])</span>
<span class="sd">            tform = tform(data)</span>

<span class="sd">        &lt;json&gt;</span>
<span class="sd">        [</span>
<span class="sd">            {&quot;name&quot;: &quot;fields&quot;, &quot;type&quot;: &quot;list:string&quot;, &quot;value&quot;: &quot;&quot;}</span>
<span class="sd">        ]</span>
<span class="sd">        &lt;/json&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">fields</span></div>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="n">new_data</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="n">new_data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">new_data</span></div>


<div class="viewcode-block" id="ResampleNiftiVolumes"><a class="viewcode-back" href="../../../eisen/api.html#eisen.transforms.imaging.ResampleNiftiVolumes">[docs]</a><span class="k">class</span> <span class="nc">ResampleNiftiVolumes</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transform resampling nifti volumes to a new resolution (expressed in millimeters).</span>
<span class="sd">    This transform can be only applied to fields of the data dictionary containing objects of type Nifti (nibabel)</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        from eisen.transforms import ResampleNiftiVolumes</span>
<span class="sd">        tform = ResampleNiftiVolumes([&#39;nifti_data&#39;], [1.0, 1.0, 1.0], &#39;linear&#39;)</span>
<span class="sd">        tform = tform(data)</span>

<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="ResampleNiftiVolumes.__init__"><a class="viewcode-back" href="../../../eisen/api.html#eisen.transforms.imaging.ResampleNiftiVolumes.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">resolution</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param fields: list of names of the fields of data dictionary to work on</span>
<span class="sd">        :type fields: list of str</span>
<span class="sd">        :param resolution: vector of float values expressing desired resolution in mm</span>
<span class="sd">        :type resolution: list of float</span>
<span class="sd">        :param interpolation: interpolation strategy to use</span>
<span class="sd">        :type interpolation: string</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            from eisen.transforms import ResampleNiftiVolumes</span>
<span class="sd">            tform = ResampleNiftiVolumes(</span>
<span class="sd">                fields=[&#39;nifti_data&#39;],</span>
<span class="sd">                resolution=[1.0, 1.0, 1.0],</span>
<span class="sd">                interpolation=&#39;linear&#39;</span>
<span class="sd">            )</span>

<span class="sd">        &lt;json&gt;</span>
<span class="sd">        [</span>
<span class="sd">            {&quot;name&quot;: &quot;fields&quot;, &quot;type&quot;: &quot;list:string&quot;, &quot;value&quot;: &quot;&quot;},</span>
<span class="sd">            {&quot;name&quot;: &quot;resolution&quot;, &quot;type&quot;: &quot;list:float&quot;, &quot;value&quot;: &quot;&quot;},</span>
<span class="sd">            {&quot;name&quot;: &quot;interpolation&quot;, &quot;type&quot;: &quot;string&quot;, &quot;value&quot;:</span>
<span class="sd">                [</span>
<span class="sd">                    &quot;linear&quot;,</span>
<span class="sd">                    &quot;nearest&quot;</span>
<span class="sd">                ]</span>
<span class="sd">            }</span>
<span class="sd">        ]</span>
<span class="sd">        &lt;/json&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interpolation</span> <span class="o">=</span> <span class="n">interpolation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="n">resolution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">fields</span></div>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param data: Data dictionary to be processed by this transform</span>
<span class="sd">        :type data: dict</span>
<span class="sd">        :return: Updated data dictionary</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="n">original_spacing</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">get_zooms</span><span class="p">()</span>
            <span class="n">original_shape</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">get_data_shape</span><span class="p">()</span>

            <span class="n">image_t</span> <span class="o">=</span> <span class="n">resample_img</span><span class="p">(</span>
                <span class="n">img</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">],</span>
                <span class="n">target_affine</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">resolution</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span><span class="p">[</span><span class="mi">2</span><span class="p">]]),</span>
                <span class="n">interpolation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">interpolation</span>
            <span class="p">)</span>

            <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">image_t</span>
            <span class="n">data</span><span class="p">[</span><span class="n">field</span> <span class="o">+</span> <span class="s1">&#39;_original_spacing&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">original_spacing</span>
            <span class="n">data</span><span class="p">[</span><span class="n">field</span> <span class="o">+</span> <span class="s1">&#39;_original_shape&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">original_shape</span>

        <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="NiftiToNumpy"><a class="viewcode-back" href="../../../eisen/api.html#eisen.transforms.imaging.NiftiToNumpy">[docs]</a><span class="k">class</span> <span class="nc">NiftiToNumpy</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This transform allows a Nifti volume to be converted to Numpy format. It is necessary to have this transform</span>
<span class="sd">    at a certain point of every transformation chain as PyTorch uses data in Numpy format before converting it</span>
<span class="sd">    to PyTorch Tensor.</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        from eisen.transforms import NiftiToNumpy</span>
<span class="sd">        tform = NiftiToNumpy([&#39;image&#39;, &#39;label&#39;])</span>
<span class="sd">        tform = tform(data)</span>


<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="NiftiToNumpy.__init__"><a class="viewcode-back" href="../../../eisen/api.html#eisen.transforms.imaging.NiftiToNumpy.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fields</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param fields: list of names of the fields of data dictionary to convert from Nifti to Numpy</span>
<span class="sd">        :type fields: list of str</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            from eisen.transforms import NiftiToNumpy</span>
<span class="sd">            tform = NiftiToNumpy(fields=[&#39;image&#39;, &#39;label&#39;])</span>
<span class="sd">            tform = tform(data)</span>

<span class="sd">        &lt;json&gt;</span>
<span class="sd">        [</span>
<span class="sd">            {&quot;name&quot;: &quot;fields&quot;, &quot;type&quot;: &quot;list:string&quot;, &quot;value&quot;: &quot;&quot;}</span>
<span class="sd">        ]</span>
<span class="sd">        &lt;/json&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">fields</span></div>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param data: Data dictionary to be processed by this transform</span>
<span class="sd">        :type data: dict</span>
<span class="sd">        :return: Updated data dictionary</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="n">entry_t</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">entry_t</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">entry_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">entry_t</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>  <span class="c1"># channel first if image is multichannel</span>

            <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry_t</span>

        <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="CropCenteredSubVolumes"><a class="viewcode-back" href="../../../eisen/api.html#eisen.transforms.imaging.CropCenteredSubVolumes">[docs]</a><span class="k">class</span> <span class="nc">CropCenteredSubVolumes</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transform implementing padding/cropping of 3D volumes. A 3D volume processed with this transform will be cropped</span>
<span class="sd">    or padded so that its final size will be corresponding to what specified by the user during instantiation.</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        from eisen.transforms import CropCenteredSubVolumes</span>
<span class="sd">        tform = CropCenteredSubVolumes([&#39;image&#39;, &#39;label&#39;], [128, 128, 128])</span>
<span class="sd">        tform = tform(data)</span>

<span class="sd">    Will crop the content of the data dictionary at keys &#39;image&#39; and &#39;label&#39; (which need to be 3+D numpy volumes) to</span>
<span class="sd">    a size of 128 cubic pixels.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="CropCenteredSubVolumes.__init__"><a class="viewcode-back" href="../../../eisen/api.html#eisen.transforms.imaging.CropCenteredSubVolumes.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param fields: field of the data dictionary to modify and replace with cropped volumes</span>
<span class="sd">        :type fields: list of str</span>
<span class="sd">        :param size: list of 3 integers expressing the desired size of the cropped volumes</span>
<span class="sd">        :type size: list of int</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            from eisen.transforms import CropCenteredSubVolumes</span>
<span class="sd">            tform = CropCenteredSubVolumes(</span>
<span class="sd">                fields=[&#39;image&#39;, &#39;label&#39;],</span>
<span class="sd">                size=[128, 128, 128]</span>
<span class="sd">            )</span>
<span class="sd">            tform = tform(data)</span>

<span class="sd">        &lt;json&gt;</span>
<span class="sd">        [</span>
<span class="sd">            {&quot;name&quot;: &quot;fields&quot;, &quot;type&quot;: &quot;list:string&quot;, &quot;value&quot;: &quot;&quot;},</span>
<span class="sd">            {&quot;name&quot;: &quot;size&quot;, &quot;type&quot;: &quot;list:int&quot;, &quot;value&quot;: &quot;&quot;}</span>
<span class="sd">        ]</span>
<span class="sd">        &lt;/json&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">fields</span></div>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="n">image_entry</span><span class="p">,</span> <span class="n">pad_before</span><span class="p">,</span> <span class="n">pad_after</span> <span class="o">=</span> <span class="n">pad_to_minimal_size</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">pad_mode</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">)</span>

            <span class="n">h_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">centr_pix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">image_entry</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:])</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

            <span class="n">start_px</span> <span class="o">=</span> <span class="p">(</span><span class="n">centr_pix</span> <span class="o">-</span> <span class="n">h_size</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

            <span class="n">end_px</span> <span class="o">=</span> <span class="p">(</span><span class="n">start_px</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">end_px</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">image_entry</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]))</span>
            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">start_px</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>

            <span class="n">image_patch</span> <span class="o">=</span> <span class="n">image_entry</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">start_px</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">end_px</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">start_px</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="n">end_px</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">start_px</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="n">end_px</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>

            <span class="n">crop_before</span> <span class="o">=</span> <span class="n">start_px</span>
            <span class="n">crop_after</span> <span class="o">=</span> <span class="n">image_entry</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span> <span class="o">-</span> <span class="n">end_px</span> <span class="o">-</span> <span class="mi">1</span>

            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">image_patch</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:])</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

            <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">image_patch</span>

            <span class="n">data</span><span class="p">[</span><span class="n">field</span> <span class="o">+</span> <span class="s1">&#39;_start_px&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crop_before</span> <span class="o">-</span> <span class="n">pad_before</span>

            <span class="n">data</span><span class="p">[</span><span class="n">field</span> <span class="o">+</span> <span class="s1">&#39;_end_px&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crop_after</span> <span class="o">-</span> <span class="n">pad_after</span>

        <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="MapValues"><a class="viewcode-back" href="../../../eisen/api.html#eisen.transforms.imaging.MapValues">[docs]</a><span class="k">class</span> <span class="nc">MapValues</span><span class="p">:</span>
<div class="viewcode-block" id="MapValues.__init__"><a class="viewcode-back" href="../../../eisen/api.html#eisen.transforms.imaging.MapValues.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">min_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">channelwise</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param fields:</span>
<span class="sd">        :type fields: list of str</span>
<span class="sd">        :param min_value:</span>
<span class="sd">        :type min_value: float</span>
<span class="sd">        :param max_value:</span>
<span class="sd">        :type max_value: float</span>
<span class="sd">        :param channelwise:</span>
<span class="sd">        :type channelwise: bool</span>

<span class="sd">        &lt;json&gt;</span>
<span class="sd">        [</span>
<span class="sd">            {&quot;name&quot;: &quot;fields&quot;, &quot;type&quot;: &quot;list:string&quot;, &quot;value&quot;: &quot;&quot;},</span>
<span class="sd">            {&quot;name&quot;: &quot;min_value&quot;, &quot;type&quot;: &quot;float&quot;, &quot;value&quot;: &quot;0&quot;},</span>
<span class="sd">            {&quot;name&quot;: &quot;max_value&quot;, &quot;type&quot;: &quot;float&quot;, &quot;value&quot;: &quot;1&quot;},</span>
<span class="sd">            {&quot;name&quot;: &quot;channelwise&quot;, &quot;type&quot;: &quot;bool&quot;, &quot;value&quot;: &quot;true&quot;}</span>
<span class="sd">        ]</span>
<span class="sd">        &lt;/json&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">fields</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_value</span> <span class="o">=</span> <span class="n">min_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_value</span> <span class="o">=</span> <span class="n">max_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channelwise</span> <span class="o">=</span> <span class="n">channelwise</span></div>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">channelwise</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> \
                        <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">][</span><span class="n">i</span><span class="p">]))</span> <span class="o">/</span> \
                        <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="n">EPS</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]))</span> <span class="o">/</span> \
                    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">])</span> <span class="o">+</span> <span class="n">EPS</span><span class="p">)</span>

            <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_value</span>
            <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_value</span>

        <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="ThresholdValues"><a class="viewcode-back" href="../../../eisen/api.html#eisen.transforms.imaging.ThresholdValues">[docs]</a><span class="k">class</span> <span class="nc">ThresholdValues</span><span class="p">:</span>
<div class="viewcode-block" id="ThresholdValues.__init__"><a class="viewcode-back" href="../../../eisen/api.html#eisen.transforms.imaging.ThresholdValues.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;greater&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param fields:</span>
<span class="sd">        :type fields: list of str</span>
<span class="sd">        :param threshold:</span>
<span class="sd">        :type threshold: float</span>
<span class="sd">        :param direction:</span>
<span class="sd">        :type direction: string</span>

<span class="sd">        &lt;json&gt;</span>
<span class="sd">        [</span>
<span class="sd">            {&quot;name&quot;: &quot;fields&quot;, &quot;type&quot;: &quot;list:string&quot;, &quot;value&quot;: &quot;&quot;},</span>
<span class="sd">            {&quot;name&quot;: &quot;threshold&quot;, &quot;type&quot;: &quot;float&quot;, &quot;value&quot;: &quot;0&quot;},</span>
<span class="sd">            {&quot;name&quot;: &quot;direction&quot;, &quot;type&quot;: &quot;string&quot;, &quot;value&quot;:</span>
<span class="sd">                [</span>
<span class="sd">                    &quot;greater&quot;,</span>
<span class="sd">                    &quot;smaller&quot;,</span>
<span class="sd">                    &quot;greater/equal&quot;,</span>
<span class="sd">                    &quot;smaller/equal&quot;</span>
<span class="sd">                ]</span>
<span class="sd">            }</span>
<span class="sd">        ]</span>
<span class="sd">        &lt;/json&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">fields</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span></div>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;greater&#39;</span><span class="p">:</span>
                <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;smaller&#39;</span><span class="p">:</span>
                <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;greater/equal&#39;</span><span class="p">:</span>
                <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;smaller/equal&#39;</span><span class="p">:</span>
                <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;the direction of inequality </span><span class="si">{}</span><span class="s1"> is not supported&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">direction</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="AddChannelDimension"><a class="viewcode-back" href="../../../eisen/api.html#eisen.transforms.imaging.AddChannelDimension">[docs]</a><span class="k">class</span> <span class="nc">AddChannelDimension</span><span class="p">:</span>
<div class="viewcode-block" id="AddChannelDimension.__init__"><a class="viewcode-back" href="../../../eisen/api.html#eisen.transforms.imaging.AddChannelDimension.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fields</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param fields:</span>
<span class="sd">        :type fields: list of str</span>

<span class="sd">        &lt;json&gt;</span>
<span class="sd">        [</span>
<span class="sd">            {&quot;name&quot;: &quot;fields&quot;, &quot;type&quot;: &quot;list:string&quot;, &quot;value&quot;: &quot;&quot;}</span>
<span class="sd">        ]</span>
<span class="sd">        &lt;/json&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">fields</span></div>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="LabelMapToOneHot"><a class="viewcode-back" href="../../../eisen/api.html#eisen.transforms.imaging.LabelMapToOneHot">[docs]</a><span class="k">class</span> <span class="nc">LabelMapToOneHot</span><span class="p">:</span>
<div class="viewcode-block" id="LabelMapToOneHot.__init__"><a class="viewcode-back" href="../../../eisen/api.html#eisen.transforms.imaging.LabelMapToOneHot.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">classes</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param fields:</span>
<span class="sd">        :type fields: list of str</span>
<span class="sd">        :param classes:</span>
<span class="sd">        :type classes: list of int</span>

<span class="sd">        &lt;json&gt;</span>
<span class="sd">        [</span>
<span class="sd">            {&quot;name&quot;: &quot;fields&quot;, &quot;type&quot;: &quot;list:string&quot;, &quot;value&quot;: &quot;&quot;},</span>
<span class="sd">            {&quot;name&quot;: &quot;classes&quot;, &quot;type&quot;: &quot;list:int&quot;, &quot;value&quot;: &quot;&quot;}</span>
<span class="sd">        ]</span>
<span class="sd">        &lt;/json&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">fields</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="n">classes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_channels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>

        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>

            <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

            <span class="n">onehot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">num_channels</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_channels</span><span class="p">):</span>
                <span class="n">onehot</span><span class="p">[</span><span class="n">c</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">[</span><span class="n">c</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

            <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="n">onehot</span>

        <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="StackImagesChannelwise"><a class="viewcode-back" href="../../../eisen/api.html#eisen.transforms.imaging.StackImagesChannelwise">[docs]</a><span class="k">class</span> <span class="nc">StackImagesChannelwise</span><span class="p">:</span>
<div class="viewcode-block" id="StackImagesChannelwise.__init__"><a class="viewcode-back" href="../../../eisen/api.html#eisen.transforms.imaging.StackImagesChannelwise.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">dst_field</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param fields:</span>
<span class="sd">        :type fields: list of str</span>
<span class="sd">        :param dst_field:</span>
<span class="sd">        :type dst_field: str</span>

<span class="sd">        &lt;json&gt;</span>
<span class="sd">        [</span>
<span class="sd">            {&quot;name&quot;: &quot;fields&quot;, &quot;type&quot;: &quot;list:string&quot;, &quot;value&quot;: &quot;&quot;},</span>
<span class="sd">            {&quot;name&quot;: &quot;dst_field&quot;, &quot;type&quot;: &quot;string&quot;, &quot;value&quot;: &quot;&quot;}</span>
<span class="sd">        ]</span>
<span class="sd">        &lt;/json&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">fields</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dst_field</span> <span class="o">=</span> <span class="n">dst_field</span></div>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>

        <span class="n">composite_image</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="n">composite_image</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>

        <span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dst_field</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">composite_image</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="FixedMeanStdNormalization"><a class="viewcode-back" href="../../../eisen/api.html#eisen.transforms.imaging.FixedMeanStdNormalization">[docs]</a><span class="k">class</span> <span class="nc">FixedMeanStdNormalization</span><span class="p">:</span>
<div class="viewcode-block" id="FixedMeanStdNormalization.__init__"><a class="viewcode-back" href="../../../eisen/api.html#eisen.transforms.imaging.FixedMeanStdNormalization.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param fields:</span>
<span class="sd">        :type fields: list of str</span>
<span class="sd">        :param mean:</span>
<span class="sd">        :type mean: float</span>
<span class="sd">        :param std:</span>
<span class="sd">        :type std: float</span>

<span class="sd">        &lt;json&gt;</span>
<span class="sd">        [</span>
<span class="sd">            {&quot;name&quot;: &quot;fields&quot;, &quot;type&quot;: &quot;list:string&quot;, &quot;value&quot;: &quot;&quot;},</span>
<span class="sd">            {&quot;name&quot;: &quot;mean&quot;, &quot;type&quot;: &quot;float&quot;, &quot;value&quot;: &quot;&quot;},</span>
<span class="sd">            {&quot;name&quot;: &quot;std&quot;, &quot;type&quot;: &quot;float&quot;, &quot;value&quot;: &quot;&quot;}</span>
<span class="sd">        ]</span>
<span class="sd">        &lt;/json&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">std</span> <span class="o">!=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">fields</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">mean</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">std</span> <span class="o">=</span> <span class="n">std</span></div>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span>

        <span class="k">return</span> <span class="n">data</span></div>
</pre></div>

             </article>
             
            </div>
            <footer>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright The Eisen Team.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              
            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
         <script type="text/javascript" src="../../../_static/jquery.js"></script>
         <script type="text/javascript" src="../../../_static/underscore.js"></script>
         <script type="text/javascript" src="../../../_static/doctools.js"></script>
         <script type="text/javascript" src="../../../_static/language_data.js"></script>
     

  

  <script type="text/javascript" src="../../../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../../../_static/js/vendor/bootstrap.min.js"></script>
  <script type="text/javascript" src="../../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
    <div class="container">
      <div class="row">
        <div class="col-md-4 text-center">
          <h2>Docs</h2>
          <p>Access comprehensive developer documentation for Eisen</p>
          <a class="with-right-arrow" href="https://eisen-ai.github.io/docs/index.html">View Docs</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Tutorials</h2>
          <p>Get in-depth tutorials for beginners and advanced developers</p>
          <a class="with-right-arrow" href="https://eisen-ai.github.io/docs/eisen/tutorials.html">View Tutorials</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Resources</h2>
          <p>Find development resources and get your questions answered</p>
          <a class="with-right-arrow" href="https://pytorch.org/resources">View Resources</a>
        </div>
      </div>
    </div>
  </div>

  <footer class="site-footer">
  </footer>

  <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="../../../_static/images/pytorch-x.svg">
  </div>
</div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="http://docs.eisen.ai/" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://eisen-ai.github.io/docs/index.html">Home</a>
          </li>

          <li>
            <a href="https://eisen-ai.github.io/docs/eisen/getstarted.html">Get Started</a>
          </li>

          <li>
            <a href="https://pytorch.org/ecosystem">Tutorials</a>
          </li>

          <li>
            <a href="https://eisen-ai.github.io/docs/eisen/features.html">Features</a>
          </li>

        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../../../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>